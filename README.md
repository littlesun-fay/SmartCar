# SmartCar
前言
智能小车作为现代的新发明，是以后的发展方向，它可以在一定范围内根据人的操控在一个环境里进行相应的运作，可应用于科学勘探和其他比较危险操作等的用途。随着汽车工业的迅速发展，关于汽车的研究也就越来越受人关注。全国电子大赛等各种电子大赛几乎每次都有智能小车这方面的题目，全国各高校也都很重视该题目的研究。所以，所以我们受此启发也进行了相关学习并设计了一款可以实现基本操作的智能控制小车，实现手机端对小车的人为控制。
1 总体方案设计
若要实现控制，首先便是要实现与小车之间的通讯，除了一般利用的蓝牙等通讯手段，还可以采用无线局域网的方式，来实现小车与手机之间的通讯。NodeMCU是物联网领域，常见的、性价比高的一款MCU，可以利用这款MCU来制作智能小车。
基本原理与方法：将手机与微机连接到同一WIFI中，实现socket通信，然后利用NodeMCU充当服务端，手机充当客户端；手机访问提前绑定的IP地址后，服务端将控制页面发送到手机浏览器中，然后利用手机浏览器发送指令；NodeMCU经过解析识别出客户端发来的控制指令，对应相应的小车控制函数，通过GPIO口电平的变化实现对L298N的控制；最后L298N又以一定的逻辑关系控制电机的转动情况。信号流图框架如图1所示。
                                      图1 信号流图
2 硬件及制动部分
2.1 硬件模块
（1）NodeMCU模块
NodeMCU,如图2所示，是一个开源的物联网平台。 它使用Lua脚本语言编程。该平台基于eLua开源项目,底层使用ESP8266 sdk 0.9.5版本。该平台使用了很多开源项目, 例如lua-cjson,spiffs。NodeMCU包含了可以运行在esp8266 Wi-Fi SoC芯片之上的固件,以及基于ESP-12模组的硬件。
图2 NodeMCU
（2）L298N
L298N是专用驱动集成电路，属于H桥集成电路，其输出电流为2A，最高电流4A，最高工作电压50V，可以驱动感性负载，如大功率直流电机，步进电机，电磁阀等，特别是其输入端可以与单片机直接相联，从而很方便地受单片机控制。当驱动直流电机时，可以直接控制步进电机，并可以实现电机正转与反转，实现此功能只需改变输入端的逻辑电平。
　　L298N芯片可以驱动两个二相电机，也可以驱动一个四相电机，输出电压最高可达50V，可以直接通过电源来调节输出电压；可以直接用单片机的IO口提供信号；而且电路简单，使用比较方便。L298N可接受标准TTL逻辑电平信号VSS，VSS可接4．5～7V电压。4脚VS接电源电压，VS电压范围VIH为＋2．5～46V。输出电流可达2A，可驱动电感性负载。1脚和15脚下管的发射极分别单独引出以便接入电流采样电阻，形成电流传感信号。L298可驱动2个电动机，OUT1，OUT2和OUT3，OUT4之间可分别接电动机，本装置我们选用驱动两台电动机控制电机的正反转。EnA，EnB接控制使能端，控制电机的停转。图3是L298N内部原理图。
图3 L298N内部原理图
2.2 制动部分
如图4所示，我们利用L298N模块对两个电机进行控制，左轮前转实现右转，右轮前转实现左转，两轮前转直行，后转后退。
                           图4 小车及连线
3 软件及网页部分
3.1 软件
Socket就是一个网络编程的接口（API），它定义了一种标准，并对TCP/IP进行封装，实现了网络传输数据的能力。在socket通信中也是这样，分为TCP、UDP两种。TCP（Transmission Control Protocol，传输控制协议）是基于连接的协议，也就是说，在正式收发数据前，必须和对方建立可靠的连接。UDP（User Data Protocol，用户数据报协议）是与TCP相对应的协议。它是面向非连接的协议，它不与对方建立连接，而是直接就把数据包发送过去。
首先，客户端和服务端会分别新建一个socket，服务端的socket需要通过bind()来绑定上端口，启动listen()进行实时监听，并等待客户端的接入，即accept()。而客户端则需要通过服务器IP和端口两个参数来建立connect()连接，此时，服务器会得到有新客户端连接的信息，启动read()等待客户端数据的传人，客户端如果成功接收到服务端的连接成功后，继续执行write()来向服务端发生数据，同理，服务端也使用这样的模式回馈客户端的数据，知道客户端关闭，服务端会收到客户端退出连接的消息，服务器重新进入等待状态，等待新客户端的进入。我们采用TCP协议采用python编程语言

